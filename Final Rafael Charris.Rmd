---
title: 'The effect of UCT in Kenya: An RCT'
author: "Rafael Charris"
date: "11/22/2021"
header-includes:
   - \usepackage[utf8]{inputenc}
output:
  pdf_document: 
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(foreign) # use this instead of haven to merge the data frames
library(tidyverse)
library(rethinking)
library(tidybayes.rethinking)
library(tidybayes)
library(haven)
library(sf)
library(dagitty)
library(table1)
library(leaflet)
library(htmltools) # tools for the map
library(lme4)
library(mice)
library(ggpubr)
library(naniar)

theme_set(theme_minimal())
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
# Reduced data frame
df <- read_dta("./data/cashtransfers_v12.dta")

# Full data frame
df_original <- read_dta("./data/UCT_FINAL_CLEAN.dta")
# merge my toy df with the big one 
df_temp <- df_original %>%
  right_join(df, by = c("surveyid" = "household_id")) %>%
  mutate(savings = asset_savings_ppp1*749.2802, #converts form dollars to KES at the time
         food_insecurity_index = fs_hhfoodindexnew_full0*749.2802)  %>%
  select(surveyid, savings, food_insecurity_index)
# get the new variables to the df
df <- df %>%
  left_join(df_temp, by = c("household_id" = "surveyid")) %>%
  select(-c(savings, food_insecurity_index)) %>% #Not using these
  unique()
  
## Villages data
df_v <- readxl::read_excel("./data/villages.xls")
df_foreing <- read.dta("./data/cashtransfers_v12.dta")
df_merge <- df_foreing %>%
  left_join(df_v, by = "village")

#my_original_df %>% 
#  select(cons_social, cons_social_ppp_m0, cons_social_ppp_m1, cons_social_ppp_m_full0, #cons_social_ppp_m_miss0) %>% 
#  mutate(transformed = cons_social/ cons_social_ppp_m1) 
# The value in the original data set times 749.2802 gives the number on my small data set

## Price level Analysis
# for the price analysis
price_plot <- df_merge %>% 
  group_by(village) %>%
  mutate(transaction = ifelse(treat == 1 | spillover == 1, 1, 0), num_people = n()) %>%
  distinct(village, .keep_all = TRUE) %>%
  select(village, sublocation, longitude, latitude, v_price_index, purecontrol, transaction, num_people)
price_plot_summary <- price_plot %>%
  group_by(purecontrol) %>%
  summarise(mean_price = mean(v_price_index),
            sd_price = sd(v_price_index),
            n = n(),
            num_people = sum(num_people))
```

# Introduction

Unconditional cash transfers (UCT) is one kind of program used to fight poverty. Unlike the conditional  cash transfers programs, UCT do not require the recipient to fulfill some sort of obligation. The idea behind this is that imposing outside constrains in the recipients can be very costly for the recipients because each persons situation is different: taking their kids to school, or going to unemployment programs are not their priority. Giving people the money directly allows them to allocate these resources as they see fit.
Besides, giving people  money directly can be cheaper because there are no monitoring nor enforcing costs.
<!--
For example, in Colombia there is the program Familias en Acción which gives money to families with the lowest income in the country conditional on they having their children in school.
--->

However, critics of this measures point out that there may be unintended consequences of giving money to everyone. For once, it would reduce the incentive to work. This would create a labor market shortage that would have an impact of prices: business would have to pay more to hire someone and would transfer this extra cost to consumers, rising the prices.
This increase in prices or inflation would make the policy useless: yes, people would have more cash in their hands or money in their bank accounts but it would be less valuable (REFERECES).

The purpose of this paper is to explore the data from a field experiment conducted between 2011 and 2013 in different villages in west Kenya by the NGO **Give Directly** (GD). The purpose of this NGO is to make unconditional cash transfers to poor households in developing countries. The evaluation of this program was conducted by a team of researchers from Princeton and Busara Center of Behavioral Economics led by Johannes Haushofer and Jeremy Shapiro.The experiment gave out money to different households with the purpose of understanding how this money would affect their economic and psychological situation. They also intended to tesk whether there would be any effects on prices in the villages.

# Design

The design has two levels of randomization and three treatments. First the team identified villages in Rarieda, in the west part of the country, that had the highest proportion of thatched roofs. Once identified, they randomly choose 120 villages and within these villages, they choose certain households with the help of the village elderly.
(This may have affected the randomization process).

```{r echo=FALSE, out.width='50%', fig.cap="Two level randomization",fig.align='center'}
knitr::include_graphics('/Volumes/GoogleDrive-108720290059105288703/My Drive/Fall 2021/614/Final Project/Final/design.png')
```


After identification, representatives of GD went to each elected household and told the recipient that they would received 404 USD total (25.200 KES ) .They were given a SIM card and were asked to register to the service M-Pesa: a mobile banking service present in Kenya, Tanzania, Afganistan, Uganda, Rwanda and Tanzania.
The chosen villages had around 100 households each. Within each households, around 9\% of the households chosen per village.
The minimum wage in 2012 in Kenya was 13.471 KES, so the total transfer during the duration of the program was twice the monthly minimum wage in the country.
If the thatched roofs criteria for identifying low income households is successful, is likely that these households' income is below the average minimum wage.

Figure 1 shows the map of the Rarieda´s Map with the location of the villages that took part in the study.

```{r, fig.cap = "Map of treated and non treated villages", echo=FALSE, fig.cap=c(3,4), warning=FALSE, message=FALSE, out.width = '75%',fig.align='center'}
pal <- colorNumeric(
  palette  = c("green3", "red"), 
  domain = df$purecontrol)
price_plot%>%
  leaflet() %>%
  addTiles() %>%
  addCircles(label = ~htmlEscape(village),
             color = ~pal(transaction)) %>%
  addLegend(
    title = "Received Transaction",
    label = c("Yes", "No"),
            color = ~pal(unique(transaction)))
```

The effects (or lack of thereof) that i find here may be due to the scale of this experiment in particular and not a reflection of the effect of giving money to the whole population. This effect could be very different in prices in particular. Nevertheless, this is a good start to explore whether this is a feasible strategy to help the poorest members of society.

## Research Questions:

1. Does receiving unconditional cash transfer increases psychological well being relative to the control group?

2. Does receiving unconditional cash transfer increases spending ? 

3. Does the effect of spending is different for male and female recipients?

4. Does receiving UCT increase the prices in the villages that receive this money relative to those that did not received it?

# Models

## Social Consumption

Social Consumption is a variable that measures the amount of money in KES on expenditure by every member of the household on ceremonies, weddings, funerals, dowry, village elders, and any other recreation (cinema tickets, music/CDs, books/magazines, etc.) in the past 12 months in KES. This measure was self-reported by the households, so is very prone to measurement error. Simply because memory is fragile or because of social desirability bias. People that receive the UCT could exaggerate the amount of money they dedicated to their kids, education or savings hopping that this "good" results would keep the program going.

```{r, echo = FALSE, fig.dim = c(3,4), fig.cap = "DAG for question 1"}
dag_q1 <- dagitty(
  "dag{
  Treatment ->  SocialConsumption
  Gender -> SocialConsumption
  NumKids -> SocialConsumption
  NumKids -> HouseholdSize
  HouseholdSize -> SocialConsumption
  Education -> SocialConsumption
  Education -> NumKids
  NeighborTreated -> SocialConsumption
  Treatment -> Income -> SocialConsumption
  }"
)
plot(dag_q1)
```

Taking into account this caveats, a model that can be used to estimate the effect of the treatment on social consumption is the following:

$$\text{Social Consumption}_{stnd} \sim \text{Normal}(\mu, \sigma)$$
$$\mu \sim \beta_{1[treatXfemale]} + \beta_{2[village]}*\tau + \beta_{3}\text{Numkids} + \beta_{4}\text{HHSize}$$
$$\beta_{1[treatXfemale]} \sim \text{Normal}(0, 2)$$
$$\tau \sim \text{Exponential}(1) $$
$$\sigma \sim \text{Exponential}(1)$$

This is a multilevel model because it assumes that each village has a different intercept. The formulation is different from the most traditional but is equivalent to assuming that the great mean $\bar{alpha}$ is 

The model assumes that social consumption is distributed normally around certain $\mu$, and with certain standard deviation $\sigma$. Although consumption could be log normally distributed, where the distribution has a lower bound in zero and a very long tail to the right, I normalized the variable for easy of analysis.

The mean is dependent on the treatment and the gender of the recipient to measure the interaction effect. In this case, $\beta_{1[treatXfemale]}$ is an index variable from 1 to 4 that represents each one of the possible combinations of treatment and gender of the recipient that shows in the table below:

|$\beta_{1[treatXfemale]}$|  female | treat  |  N |
|---|---|---|---|
| 1 | 0 | 0 | 213 |
| 2 | 0 | 1 | 100 |
| 3 | 1 | 0 | 398 |
| 4 | 1 | 1 | 238 |

To estimate the effect of gender, I have to do contrasts between the coefficients


### Price 

For identifying if there was a change in price I don't need to build a model. If randomization was successful, then there should not be any systematic differences between the treated and the non-treated villages: in both groups there should be big and small villages with different characteristics, so I can run a t-test to test the hypothesis of different means.
However, in the Bayesian framework one can estimate the mean price for the treated villages with the mean price for the non-treated villages and get a distribution around each estimate that represents the uncertainty around the estimates.
The model that estimates both of this means can be written as follows:

```{r, echo = FALSE, fig.dim = c(3,4), fig.cap = "DAG for question 4"}
dag_q3 <- dagitty(
  "dag{
  Transaction -> Prices
  NeighborTransaction -> Prices
  Population -> Prices
  }"
)
plot(dag_q3)
```

$$\text{Prices} \sim \text{Normal}(\mu, \sigma)$$
$$\mu =  \alpha_{[treat]}$$
$$\alpha_{[treat]} \sim \text{Normal}(0, 5)$$
$$\sigma \sim \text{Exponential}(1)$$

where $\alpha_{[treat]}$ represents an index variable. In this case it takes two values, 1 or 2, which stands for treated village and non-treated village, respectively. This is 

I will run two models to answer questions two and three.
The first model will estimate what 
I want to know whether the extra money had an effect on the two categories of consumption measures: social and food consumption. The model should take into account that different villages may have different level of social and food consumption. To to this, I will run a random effects model (partially pooled in the Bayesian lingo).

Secondly i want to know whether this extra income had an effect on psychological well-being, l

```{r, eval = FALSE, echo = FALSE}
lme4::lmer(data = df_ml, cons_social ~ as.factor(treatXfemale) +  (1|village))
```

# Results

## Descriptive Statistics
```{r, echo = FALSE, results='asis', fig.pos='center'}
label(df_foreing$gender) <- "Gender"
label(df_foreing$age) <-  "Age (years)"
label(df_foreing$children) <- "Number of Children"
label(df_foreing$hh_size) <- "Household Size"
label(df_foreing$cons_social) <-"Social Consumption"
label(df_foreing$cons_food) <- "Food Consumption"
    
table1(~ age+ as.factor(gender) + children + hh_size + cons_social + cons_food,data = df_foreing, topclass="Rtable1-zebra")
```

## Missing Values

The missingness plot shows that there are missing values in the following variables: `age`, `gender`, `education`, `wvs_happiness`,`wvs_life_sat`, and `hh_size`.
The plot indicates that the missing values are related: the same rows have missing values for these variables. However, the measures of happiness and life satisfaction have more missing values than the rest of the variables. furthermore, the missing values correspond to the same households.
```{r, echo = FALSE, fig.cap = "Missingness Plot", fig.dim=c(4,3)}
vis_miss(df)
```

```{r, echo = FALSE}
l_results <-df %>% 
  select(village, gender, wvs_happiness, wvs_life_sat,treat, spillover, 
         age, education, cons_food, cons_social, hh_size, children) %>% 
  mcar_test()
```

Overall, there seems to be more missing values in the happiness and life satisfaction variables among the treated households (16.9%) vs the non treated households (14.9%), relative to the number of households on each treatment. The other missing values seem to be distributed equally among villages, which could be the case if there was a systematic problem that made it very hard to survey certain places more than others.

A little's test shows that the data is not MCAR (`r paste0("Chi = ", round(l_results$statistic)`, p < 0.01). Therefore, I conducted multiple imputation in case the data was NMAR.

```{r, echo = FALSE, warning=FALSE, results='hide'}
df_missing <- haven::zap_labels(df)
df_missing <- df_missing %>% 
  mutate( household_id= as.character(household_id),
          latitude = as.character(latitude),
          longitude = as.character(longitude))
m <- mice(df_missing)

df_mi <- complete(m)
```

```{r, echo = FALSE}
data <- df_mi %>%
  mutate(female = ifelse(gender == 2, 1 , 0),
         treatXfemale = treat + 2*female + 1)
data$village_id <- as.integer(as.factor(data$village))
```

## Social Consumption

For this analysis I compare the households that received the transaction against households that did not receive the transaction in villages that were not treated. That is, villages were no one received the UCT. This comparison provides the perfect contractual to measure the pure effect of the treatment. If I compare treated households and non treated households within treated villages, there is the risk of interaction or spillover effects that would make identification hard.

As the graph shows, social consumption seems to be roughly similar between treatment and control, but different between genders. There is more mass in the the lowest part of the distribution for females.
For men, there seems to be a slight shift from lower to higher values of social consumption. 
The empirical cumulative distribution is shown in Figure XX. It shows that these curves are very close to each other. A Kolmogorov-Smirnoff test shows that these curves are not statistically different both for the female recipients (p = 0.754) and for the male recipients (p = 0.3833).



```{r, echo = FALSE, fig.dim = c(8,5), fig.cap=" Distribution of amount spend in social consumption in the past 12 months"}
data %>%
  mutate(female = ifelse(female == 1, "Female", "Male")) %>%
  filter(treat == 1 | purecontrol == 1) %>%
  ggplot(aes(x = cons_social,
             fill = as.factor(treat))) +
  geom_density(alpha = 0.5) + 
  labs(y = "Density", 
       x = "KES",
       title = "Effect of Receving a Transaction on Social Consumption",
       fill = "Treatment") + 
  facet_grid(female~.)
```


```{r, echo = FALSE, fig.cap=c(5,5), fig.cap="Empirical Cumulative distribution for those that "}
data %>%
  mutate(female = ifelse(female == 1, "Female", "Male")) %>%
  filter(treat == 1 | purecontrol == 1) %>%
  ggplot(aes(x = cons_social,
             col = as.factor(treat))) +
  stat_ecdf() +
  labs(x = "KES", y = "ECDF", 
       col = "Treatment",
       title = "Cumulative Distribution function for Social consumption") +
  facet_grid(female~.)
       #subtitle = paste0("p = ",
       #                  round(ks.test(
       #                    df_mi$cons_social[df_mi$treat == 1],
       #                    df_mi$cons_social[df_mi$treat == 0 &
       #                                        df_mi$purecontrol==1])$p.value,3)))
```

```{r, echo = FALSE, results='hide'}
ks_female1 = data%>% filter(female == 1, treat ==1 )
ks_female2 = data%>% filter(female == 1, treat == 0 )
ks.test(ks_female1$cons_social, ks_female2$cons_social)

ks_male1 = data%>% filter(female == 0, treat ==1 )
ks_male2 = data%>% filter(female == 0, treat == 0 )
ks.test(ks_male1$cons_social, ks_male2$cons_social)
```

```{r, echo = FALSE}
df_ml <- data %>%
    filter(treat == 1 | purecontrol==1)
df_ml$village_id <- as.integer(as.factor(df_ml$village))

d <- list(
  cons_social = log(df_ml$cons_social + 1),
  treat = ifelse(df_ml$treat ==1, 1, 2),
  female = ifelse(df_ml$female == 1, 1, 2),
  numkids = df_ml$children,
  hhsize = df_ml$hh_size,
  treat_female = df_ml$treat*df_ml$female,
  treatXfemale = df_ml$treatXfemale,
  village = df_ml$village_id
)
```

```{r, echo = FALSE, results='hide'}
m_cons_social <- ulam(
  alist(
    cons_social ~ normal(mu, sigma),
    mu <- b1[treatXfemale] + a+ tau*b2[village] + b3*numkids + b4*hhsize,
    a ~ normal(5,2),
    b1[treatXfemale] ~ normal(5, 2),
    b2[village] ~ normal(5, 2),
    b3 ~ normal(0, 1),
    b4 ~ normal(0, 1),
    tau ~ exponential(1),
    sigma ~ exponential(1)
  ), data = d, chain = 2, iter = 2000
)

d <- list(
  cons_social = log(df_ml$cons_social + 1),
  treat = df_ml$treat,
  female = df_ml$female,
  numkids = df_ml$children,
  hhsize = df_ml$hh_size,
  treat_female = df_ml$treat*df_ml$female,
  treatXfemale = df_ml$treatXfemale,
  village = df_ml$village_id
)

m_cons_social <- ulam(
  alist(
    cons_social ~ normal(mu, sigma),
    mu <- b1*treat_female + b5*treat + b6*female + a+ tau*b2[village] + b3*numkids + b4*hhsize,
    a ~ normal(5,2),
    b1 ~ normal(5, 2),
    b2[village] ~ normal(5, 2),
    b3 ~ normal(2, 1),
    b4 ~ normal(2, 1),
    b5 ~ normal(6,3),
    b6 ~ normal(5,2),
    tau ~ exponential(1),
    sigma ~ exponential(1)
  ), data = d, chain = 2, iter = 2000
)
```

```{r, fig.cap="Estimates for the treatment effects and for the errors", fig.dim=c(4,3), echo = FALSE}
plot(precis(m_cons_social, depth = 2, pars = c("b1","tau", "sigma")))
```

The regression model proposed above would let me estimate the average treatment effect, gender effects, and the interaction effect. Given that the treatment was randomly assigned, I can assume that the characteristics of the households that received the UCT and those that did not are roughly similar. Nevertheless, I can get better estimates by including in the model number of kids, household size, age, and education, all of which likely affect the level of social consumption as shown in the DAG proposed before.

### Food Consumption


Regarding food consumption, the effects are different to social consumption
```{r, echo = FALSE, fig.dim = c(8,5), fig.cap=""}
df_ml %>%
  mutate(gender = ifelse(gender == 1, "Male", "Female")) %>%
  filter(treat == 1 | purecontrol == 1) %>%
  ggplot(aes(x = cons_food,
             fill = as.factor(treat))) +
  geom_density(alpha = 0.5) + 
  labs(y = "Density", 
       x = "KES",
       title = "Effect of Receving a Transaction on Social Consumption",
       fill = "Treatment") + 
  facet_grid(gender~.)
```


```{r, echo = FALSE, fig.cap=c(5,5)}
df_ml %>%
  filter(treat == 1 | purecontrol == 1) %>%
  mutate(gender = ifelse(gender == 1, "Male", "Female")) %>%
  ggplot(aes(x = cons_food,
             col = as.factor(treat))) +
  stat_ecdf() +
  labs(x = "KES", y = "ECDF", 
       col = "Treatment",
       title = "Cumulative Distribution function for Social consumption") +
  facet_grid(gender~.)
```


```{r echo = FALSE}
d <- list(
  cons_food = log(df_ml$cons_food + 1),
  treat = ifelse(df_ml$treat ==1, 1, 2),
  female = ifelse(df_ml$female == 1, 1, 2),
  numkids = df_ml$children,
  hhsize = df_ml$hh_size,
  treatXfemale = df_ml$treatXfemale,
  village = df_ml$village_id
)

m_cons_food <- ulam(
  alist(
    cons_food ~ normal(mu, sigma),
    mu <- b1[treatXfemale] + tau*b2[village] +b3*numkids + b4*hhsize,
    b1[treatXfemale] ~ normal(8, 4),
    b2[village] ~ normal(0, 1),
    b3 ~ normal(0, 1),
    b4 ~ normal(0, 1),
    sigma ~ exponential(1),
    tau ~ exponential(1)
      ), data = d, chain = 2, iter = 2000
)

post_pred <- predicted_draws(m_cons_food, newdata = d)

post_pred %>% 
    filter(.draw < 50) %>%
    ggplot() + 
    geom_density(aes(x = .prediction, y= ..scaled.., group = .draw), 
                 alpha = 0.1) + 
   # coord_cartesian(xlim = c(0, 6000)) + 
  geom_density(data = df_ml, aes(x=cons_food, y = ..scaled..), col = "red")

post_pred %>% 
    filter(.draw < 50) %>%
    ggplot() + 
    geom_density(aes(x = exp(.prediction), group = .draw), 
                 alpha = 0.1) + 
    # coord_cartesian(xlim = c(0, 6000)) + 
    geom_density(data = df_ml, aes(x=cons_food), col = "red") + coord_cartesian(xlim = c(0, 11000))
```

### Price Change

One of the main problems of the UCT programs is that prices may increase due to the extra cash that flows into the system. The research team calculated a price index for each village. The price index is centered around 0 

```{r, echo = FALSE, fig.cap="", results='hide', message=FALSE, warning=FALSE}
d2 <- list(
price = price_plot$v_price_index,
treat = ifelse(price_plot$transaction == 1, 1, 2)
)
m_price <- ulam(
  alist(
    price ~ normal(mu, sigma),
    mu <-b1[treat],
    b1[treat] ~ normal(0, 5),
    sigma ~ exponential(1)
  ), data = d2, chains=2, iter = 2000
)
post_m_price <- extract.samples(m_price)
post_m_price$diff_price <- post_m_price$b1[,2] - post_m_price$b1[,1]
```

```{r, echo = FALSE, fig.cap="Distribution of differences between the beta estimates from ", fig.cap=c(4,4)}
post_m_price %>%
  as.data.frame() %>%
ggplot(aes(x = diff_price)) +
  geom_density() + 
  geom_vline(xintercept = price_plot_summary["mean_price"][[2,1]] - price_plot_summary["mean_price"][[1,1]]) + 
  labs(x = "Difference in Prices Indices")
```
```{r t_test, echo = FALSE}
rs <- t.test(price_plot$v_price_index ~ price_plot$transaction)
```

The mean difference is not statistically different `r paste0("t= ",round(rs$statistic[[1]]), " p = ", round(rs$p.value[[1]],3))`. The box plots show that both the treated and the non-treated villages are similarly distributed around the mean price index.

```{r, echo =FALSE, fig.cap="Boxplot of the distribution of prices", fig.dim=c(3,4)}
p1 <- ggplot(price_plot, 
       aes(x = as.factor(purecontrol), 
           y = v_price_index
       )) +
  geom_boxplot(
  ) + 
  labs(y = "Price Index", x = "Treated Villages") 

p2 <- ggplot(price_plot, 
       aes(x = as.factor(purecontrol), 
           y = v_price_index
       )) +
  geom_jitter(
    width = 0.25
  ) + 
  stat_summary(fun.data = mean_se,
               col = "red",
               geom = "errorbar") +
  labs(y = "Price Index", x = "Treated Villages")
#ggarrange(p1, p2, nrow = 1)
p1
```

```{r, echo = FALSE}
ol_IQR = function(z){
  z = na.omit(z)
  names(z) = NULL
  p25 = quantile(z)[2]
  p75 = quantile(z)[4]
  iqr = (p75-p25)
  iqr_l = p25-1.5*iqr
  iqr_u = p75+1.5*iqr
  w = which(z<iqr_l | z>iqr_u)

  list(idx = w,
       val = z[w],
       mu = mean(z),
       thres_l =iqr_l,
       thres_u = iqr_u
  )
}
ols_IQR = apply(price_plot["v_price_index"],2,ol_IQR)
price_plot_noutliers <- price_plot %>%
  rowid_to_column() %>%
  filter(!(rowid %in% ols_IQR$v_price_index$idx))
t.outliers <- t.test(data = price_plot_noutliers, v_price_index ~ transaction)
```

Both treatments have the same number of villages (non-treated 62 and treated 60). However, there are `r length(ols_IQR$v_price_index$val)` outliers according to the $1.5*IQR$ criteria as the box plot shows. When I remove these outliers, both groups even more similar as shown by Figure XXX, and there are still not significant differences (`r paste0("t= ",round(t.outliers$statistic[[1]]), " p = ", round(t.outliers$p.value[[1]],3))`).

The lack of identification could be due to two things: first, there no effect of these transactions on the price index. The amount was not enough to influence the prices overall. Secondly, there are hidden variables that prevent identification. For example, I don't have information on the population of the villages. On average have 100 households, but I don't know the distribution of the villages' populations. The outliers can be villages with small populations where the price was affected because the transaction was big relative to population. I don't have enough information to evaluate this hypothesis. 
Finally, I cannot conclude that absence of evidence is evidence of absence: maybe the effect exists but there was not enough power to identify it because the data is very noisy, the measure was poorly constructed, or the effect size is very small. However, I can asses that, taking these limitations into account, there is no evidence that there was a change in prices due to the unconditional cash transfer program.

```{r, echo = FALSE, fig.cap="Boxplot after identifying and removing outliers outside of the 1.5*IQR", fig.dim = c(3,4)}
ggplot(price_plot_noutliers, 
       aes(x = as.factor(purecontrol), 
           y = v_price_index
       )) +
  geom_boxplot(
  ) + 
  labs(y = "Price Index", x = "Treated Villages")
```


## Limitations 

One very important question that was not considered in the design of the paper and form which data is not available, is the effect of the transfers on the labor market. One of the criticisms to UCT, and UBI is that it will make people not go to work as their incentives will be.

## Conclusions

Regarding the research questions, one can conclude three things. There seem not to be any effects of the treatment on social consumption when we ignore gender. These results appear once we see how men and women respond to the treatment. Overall, women seem to spend more money than men, 


There is no evidence of a price increase because of the treatment. As mentioned before, the study was not design to test the hypothesis of whether UCT increase prices, but this is one pervasive criticism to these kinds of programs. It is important to point out that absence of evidence does not imply evidence of absence. There are several reasons that could explain this lack of result. First, there is a lot of variation between the villages, that could be hiding a very small effect that is difficult to detect because of lack of power. Secondly, I was not able to control by the population of each village. It is very likely that the price is more affected in less populous villages than in more populous ones. Similarly, I don't have information on the wealth of each village. It is also likely that the wealthiest villages are not that affected by the UCT as the less wealthiest ones. I cannot control by these variables.


\pagebreak
# References



